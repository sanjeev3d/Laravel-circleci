version: 2
jobs:
  build:
    machine:
      docker_layer_caching: false
    steps:
      - checkout
        # - run:
        #  name: Run docker-compose build
        #  command: docker-compose build

      - run:
          name: Install Composer
          command: |
              php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
              php -r "if (hash_file('SHA384', 'composer-setup.php') === trim(file_get_contents('https://composer.github.io/installer.sig'))) { echo 'Installer verified'; } else { echo 'Installer invalid'; unlink('composer-setup.php'); } echo PHP_EOL;"
              php composer-setup.php
              php -r "unlink('composer-setup.php');"

      - run:
          name: Laravel unit test
          command: |
            cd myApp
            composer install
            ls -ltr

        #- run: 
            # name: Run docker-compose up 
            # command: docker-compose up -d 
            
      
workflows:
  version: 2
  build-deploy:
    jobs:
      - build:
          filters:
            branches:
              only: dev
